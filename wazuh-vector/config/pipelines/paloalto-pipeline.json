{
  "description": "Palo Alto PAN-OS Syslog Parsing Pipeline - Basic template",
  "processors": [
    {
      "csv": {
        "field": "message",
        "target_fields": [
          "future_use1", "receive_time", "serial_number", "type", "threat_content_type",
          "future_use2", "generated_time", "source.ip", "destination.ip", "nat_source_ip",
          "nat_destination_ip", "rule_name", "source.user.name", "destination.user.name",
          "network.application", "virtual_system", "source.zone", "destination.zone",
          "inbound_interface", "outbound_interface", "log_action", "future_use3",
          "session_id", "repeat_count", "source.port", "destination.port",
          "nat_source_port", "nat_destination_port", "flags", "network.transport",
          "event.action", "url", "threat_id", "event.category", "event.severity",
          "direction", "sequence_number", "action_flags", "source.geo.country_name",
          "destination.geo.country_name", "future_use4", "packets_sent", "packets_received",
          "session_end_reason", "device_group_hierarchy_level_1", "device_group_hierarchy_level_2",
          "device_group_hierarchy_level_3", "device_group_hierarchy_level_4", "virtual_system_name",
          "device_name", "action_source"
        ],
        "ignore_missing": true,
        "ignore_failure": true
      }
    },
    {
      "convert": {
        "field": "source.port",
        "type": "long",
        "ignore_missing": true,
        "ignore_failure": true
      }
    },
    {
      "convert": {
        "field": "destination.port",
        "type": "long",
        "ignore_missing": true,
        "ignore_failure": true
      }
    },
    {
      "lowercase": {
        "field": "network.transport",
        "ignore_missing": true,
        "ignore_failure": true
      }
    },
    {
      "geoip": {
        "field": "source.ip",
        "target_field": "source.geo",
        "ignore_missing": true,
        "ignore_failure": true
      }
    },
    {
      "geoip": {
        "field": "destination.ip",
        "target_field": "destination.geo",
        "ignore_missing": true,
        "ignore_failure": true
      }
    },
    {
      "set": {
        "field": "observer.vendor",
        "value": "Palo Alto Networks"
      }
    },
    {
      "set": {
        "field": "observer.product",
        "value": "PAN-OS"
      }
    },
    {
      "set": {
        "field": "observer.type",
        "value": "firewall"
      }
    },
    {
      "set": {
        "field": "ecs.version",
        "value": "8.12.0"
      }
    }
  ],
  "on_failure": [
    {
      "set": {
        "field": "error.message",
        "value": "{{ _ingest.on_failure_message }}"
      }
    },
    {
      "set": {
        "field": "event.kind",
        "value": "pipeline_error"
      }
    }
  ]
}
