###################### Fluentd Configuration ######################
# Wazuh Fluentd - Multi-source syslog collector
# Version: 2.0
# OpenSearch/Wazuh Indexer compatible

# System configuration
<system>
  log_level "#{ENV['FLUENTD_LOG_LEVEL'] || 'info'}"
  # 10 workers - one for each port group
  # Each worker explicitly assigned to specific sources
  workers 10
</system>

# Capture Fluentd's own logs
<label @FLUENT_LOG>
  <match fluent.**>
    @type stdout
  </match>
</label>

# Include all configuration files from conf.d directory
@include conf.d/*.conf

# Catch-all for unmatched logs (debugging)
<match **>
  @type stdout
</match>
