###################### Fluentd Configuration ######################
# Wazuh Fluentd - Multi-source syslog collector
# Version: 2.0
# OpenSearch/Wazuh Indexer compatible

# System configuration
<system>
  log_level "#{ENV['FLUENTD_LOG_LEVEL'] || 'info'}"
  # Multi-worker mode - Fluentd automatically distributes sources
  # Sources at root level are shared across all workers
  workers 4
</system>

# Capture Fluentd's own logs
<label @FLUENT_LOG>
  <match fluent.**>
    @type stdout
  </match>
</label>

# Include all configuration files from conf.d directory
@include conf.d/*.conf

# Catch-all for unmatched logs (debugging)
<match **>
  @type stdout
</match>
