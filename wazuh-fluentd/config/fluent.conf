###################### Fluentd Configuration ######################
# Wazuh Fluentd - Multi-source syslog collector
# Version: 2.0
# OpenSearch/Wazuh Indexer compatible

# System configuration
<system>
  log_level "#{ENV['FLUENTD_LOG_LEVEL'] || 'info'}"
  # Disable workers - sources need to be in worker 0 context
  # With workers > 1, sources don't bind properly
  workers 1
</system>

# Capture Fluentd's own logs
<label @FLUENT_LOG>
  <match fluent.**>
    @type stdout
  </match>
</label>

# Include all configuration files from conf.d directory
@include conf.d/*.conf

# Catch-all for unmatched logs (debugging)
<match **>
  @type stdout
</match>
