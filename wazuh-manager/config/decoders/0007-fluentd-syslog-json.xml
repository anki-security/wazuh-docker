<!--
  Custom decoders for Fluentd syslog-wrapped JSON
  
  Input format from remote_syslog plugin with sensor hostnames:
  <134>Oct 11 00:42:12 sensor-mikrotik fluentd: {"log_source":"mikrotik","full_message":"..."}
  <134>Oct 11 00:42:12 sensor-esxi fluentd: {"log_source":"esxi","full_message":"..."}
  <134>Oct 11 00:42:12 sensor-netflow fluentd: {"log_source":"netflow","src_ip":"..."}
  
  These decoders:
  1. Match the sensor hostname pattern
  2. Extract and decode the JSON payload after "fluentd: "
-->

<!-- MikroTik Logs -->
<decoder name="sensor-mikrotik-json">
  <prematch>sensor-mikrotik fluentd:</prematch>
  <type>json</type>
</decoder>

<!-- ESXi Logs -->
<decoder name="sensor-esxi-json">
  <prematch>sensor-esxi fluentd:</prematch>
  <type>json</type>
</decoder>

<!-- NetFlow Logs -->
<decoder name="sensor-netflow-json">
  <prematch>sensor-netflow fluentd:</prematch>
  <type>json</type>
</decoder>
